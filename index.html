<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Email Receiver</title>

<style>
    body {
        margin: 0;
        padding: 0;
        font-family: "Segoe UI", sans-serif;
        background: #0d0b14;
        color: #e6dfff;
        overflow-x: hidden;
    }

    /* Aura t√≠m n·ªÅn */
    .aura {
        position: fixed;
        width: 600px;
        height: 600px;
        top: -150px;
        left: -150px;
        background: radial-gradient(circle, rgba(140, 0, 255, 0.4), transparent 70%);
        filter: blur(120px);
        z-index: 0;
        pointer-events: none;
    }

    h1 {
        text-align: center;
        margin-top: 40px;
        font-size: 38px;
        color: #c38aff;
        text-shadow: 0 0 20px #9100ff, 0 0 40px #7000e3;
    }

    .container {
        max-width: 900px;
        margin: auto;
        padding: 20px;
        margin-top: 30px;
        position: relative;
        z-index: 1;
    }

    .email-counter {
        font-size: 20px;
        margin-bottom: 20px;
        padding: 12px 18px;
        width: fit-content;
        border-radius: 12px;
        background: rgba(80, 0, 150, 0.25);
        box-shadow: 0 0 15px #5800c9;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(170, 0, 255, 0.3);
    }

    .email-card {
        background: rgba(30, 0, 60, 0.45);
        margin-bottom: 20px;
        padding: 20px;
        border-radius: 12px;
        border: 1px solid rgba(160, 0, 255, 0.2);
        box-shadow: 0 0 15px rgba(100, 0, 150, 0.4);
        backdrop-filter: blur(8px);
        transition: 0.2s ease;
    }

    .email-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 0 25px rgba(150, 0, 255, 0.5);
    }

    .email-title {
        font-size: 18px;
        font-weight: bold;
    }

    .email-from {
        color: #d4b5ff;
        font-size: 14px;
        margin-top: 6px;
        opacity: 0.9;
    }

    .email-body {
        margin-top: 15px;
        font-size: 15px;
        line-height: 1.5;
        white-space: pre-wrap;
    }

    .note-box {
        margin-top: 40px;
        padding: 15px;
        border-left: 5px solid #a300ff;
        background: rgba(50, 0, 90, 0.35);
        border-radius: 8px;
        font-size: 15px;
        box-shadow: 0 0 12px rgba(150, 0, 255, 0.4);
    }
</style>
</head>

<body>

<div class="aura"></div>

<h1>üì® Email Receiver</h1>

<div class="container">
    <div id="emailCounter" class="email-counter">ƒêang t·∫£i...</div>
    <div id="emailList"></div>

    <div class="note-box">
        <b>L∆∞u √Ω:</b>  
        C√≥ th·ªÉ s·∫Ω ph·∫£i ƒë·ª£i kh√° l√¢u ƒë·ªÉ update Email v√¨ ph·∫£i ƒë·ª£i Email t·ªõi ‚Üí Google ph·∫£n h·ªìi ‚Üí GitHub l·∫•y d·ªØ li·ªáu  
        (kho·∫£ng h∆°n <b>2 ph√∫t</b>).
    </div>
</div>

<script>
    let lastVersion = null; // L∆∞u l·∫ßn update cu·ªëi

    async function loadEmails() {
        const url = "emails.json";

        try {
            const res = await fetch(url + "?cache=" + Date.now());
            const data = await res.json();

            document.getElementById("emailCounter").innerText =
                "S·ªë l∆∞·ª£ng Email: " + data.length;

            const list = document.getElementById("emailList");
            list.innerHTML = "";

            data.forEach(email => {
                const div = document.createElement("div");
                div.className = "email-card";
                div.innerHTML = `
                    <div class="email-title">${email.subject}</div>
                    <div class="email-from">üìß T·ª´: ${email.from}</div>
                    <div class="email-body">${email.body}</div>
                `;
                list.appendChild(div);
            });

        } catch (err) {
            document.getElementById("emailCounter").innerText =
                "Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu Email.";
        }
    }

    // Ki·ªÉm tra nh·∫π xem emails.json c√≥ ƒë·ªïi kh√¥ng
    async function checkUpdate() {
        try {
            const res = await fetch("emails.json", {
                method: "HEAD",
                cache: "no-cache"
            });

            const newTag = res.headers.get("ETag") || res.headers.get("Last-Modified");

            if (!lastVersion) {
                lastVersion = newTag;
                return;
            }

            if (newTag !== lastVersion) {
                lastVersion = newTag;
                loadEmails(); // Ch·ªâ load khi c√≥ thay ƒë·ªïi th·∫≠t
            }

        } catch (e) {
            console.log("Kh√¥ng th·ªÉ ki·ªÉm tra update:", e);
        }
    }

    // Load email l·∫ßn ƒë·∫ßu
    loadEmails();

    // Ki·ªÉm tra m·ªói 3 gi√¢y (c√≥ th·ªÉ ƒë·ªïi)
    setInterval(checkUpdate, 3000);
</script>

</body>
</html>
